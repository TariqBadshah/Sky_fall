########add libraries
library(caret)

#####add working folder/working directory
setwd("E:/ms project data")
getwd()

######add data
GINICOEFFICIENT <- read.csv("E:/ms project data/GINICOEFFICIENT.csv")
GINICOEFFICIENT=data.frame(GINICOEFFICIENT[,1:43])
head(GINICOEFFICIENT)


#########################running multiple linear regression model for GINICOEFFICIENT 
lm=lm(GINICOEFFICIENT$GiniCoefficient~GINICOEFFICIENT$MIN_GR+GINICOEFFICIENT$MAX_GR+GINICOEFFICIENT$RANGE_GR+GINICOEFFICIENT$STD_GR+GINICOEFFICIENT$SUM_GR+GINICOEFFICIENT$MIN_MSI+GINICOEFFICIENT$MAX_MSI+GINICOEFFICIENT$RANGE_MSI+GINICOEFFICIENT$MEAN_MSI+GINICOEFFICIENT$STD_MSI+GINICOEFFICIENT$SUM_MSI+GINICOEFFICIENT$MIN_NDVI+GINICOEFFICIENT$STD_NDVI+GINICOEFFICIENT$SUM_NDVI+GINICOEFFICIENT$MIN_SAVI+GINICOEFFICIENT$MAX_SAVI+GINICOEFFICIENT$RANGE_SAVI+GINICOEFFICIENT$MEAN_SAVI+GINICOEFFICIENT$STD_SAVI+GINICOEFFICIENT$SUM_SAVI+GINICOEFFICIENT$MEAN_SR+GINICOEFFICIENT$MAX_SR+GINICOEFFICIENT$RANGE_SR+GINICOEFFICIENT$MEAN_SR+GINICOEFFICIENT$STD_SR+GINICOEFFICIENT$SUM_SR+GINICOEFFICIENT$MIN_SVR+GINICOEFFICIENT$MAX_SVR+GINICOEFFICIENT$RANGE_SVR+GINICOEFFICIENT$MEAN_SVR+GINICOEFFICIENT$STD_SVR+GINICOEFFICIENT$SUM_SVR+GINICOEFFICIENT$MIN_VI+GINICOEFFICIENT$MAX_VI+GINICOEFFICIENT$RANGE_VI+GINICOEFFICIENT$STD_VI+GINICOEFFICIENT$SUM_VI)

##########to check the results of the model
summary(lm)

####apply stepwise linear regression for removal of unnecessary variables by minimizing AIC creteria
step(lm)

#####make another dataframe for final variables that were selected after removal of unncessary vairables by using AIC method
GINICOEFFICIENT=data.frame(GINICOEFFICIENT$GiniCoefficient, GINICOEFFICIENT$STD_GR, GINICOEFFICIENT$SUM_GR, GINICOEFFICIENT$SUM_MSI, GINICOEFFICIENT$STD_NDVI, GINICOEFFICIENT$SUM_NDVI, GINICOEFFICIENT$MIN_SAVI, GINICOEFFICIENT$MEAN_SAVI, GINICOEFFICIENT$STD_SAVI, GINICOEFFICIENT$MEAN_SR, GINICOEFFICIENT$STD_SR, GINICOEFFICIENT$SUM_SVR, GINICOEFFICIENT$SUM_VI)
head(GINICOEFFICIENT)

##################apply final model on the remaing varialbes using 10 fold cross validation process
model<- train(GINICOEFFICIENT.GiniCoefficient ~ ., GINICOEFFICIENT, method = "lm",trControl = trainControl(method = "cv", number = 10, verboseIter = TRUE))
model

the codes for looking data stars,  ( there are upto three srtars are used in regression coefficent )
model<- lm(BIOMASS$BIOMASS.biomass ~ BIOMASS$BIOMASS.RANGE_NDVI+BIOMASS$BIOMASS.MEAN_NDVI+BIOMASS$BIOMASS.RANGE_SAVI+BIOMASS$BIOMASS.MEAN_SAVI+BIOMASS$BIOMASS.STD_SAVI+BIOMASS$BIOMASS.RANGE_SR+BIOMASS$BIOMASS.MEAN_SR+BIOMASS$BIOMASS.STD_SR+BIOMASS$BIOMASS.MEAN_VI)

model



mean(GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient)
head(GINICOEFFICIENT)

RMSE= RMSE(predict(model), GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient) 
mean(GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient)
RMSE_percentage= (RMSE/mean(GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient))*100
corr=cor(predict(model),GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient)
R2=R2(predict(model),GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient)
####FINAL RESULT
corr
R2
RMSE
RMSE_percentage
model
RMSE= RMSE(predict(model), GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient)
model
RMSE= 0.33
RMSE_percentage= (RMSE/mean(GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient))*100
RMSE= 0.33
RMSE_percentage= (RMSE/mean(GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient))*100
corr=cor(predict(model),GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient)
R2=R2(predict(model),GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient)

####FINAL RESULTS
corr
R2
RMSE
RMSE_percentage
mean(GINICOEFFICIENT$GINICOEFFICIENT.GiniCoefficient)






















it the lats i will use this code 

#########the codes for verious inflation factor 
model<- vif(BIOMASS$BIOMASS.biomass ~ BIOMASS$BIOMASS.RANGE_NDVI+BIOMASS$BIOMASS.MEAN_NDVI+BIOMASS$BIOMASS.RANGE_SAVI+BIOMASS$BIOMASS.MEAN_SAVI+BIOMASS$BIOMASS.STD_SAVI+BIOMASS$BIOMASS.RANGE_SR+BIOMASS$BIOMASS.MEAN_SR+BIOMASS$BIOMASS.STD_SR+BIOMASS$BIOMASS.MEAN_VI)
